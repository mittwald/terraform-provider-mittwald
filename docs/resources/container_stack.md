---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "mittwald_container_stack Resource - terraform-provider-mittwald"
subcategory: ""
description: |-
  This resource models a container stack.
  A container stack may consist of multiple containers and volumes.
---

# mittwald_container_stack (Resource)

This resource models a container stack.

A container stack may consist of multiple containers and volumes.

## Example Usage

```terraform
locals {
  nginx_port = 80
}

resource "mittwald_container_stack" "nginx" {
  project_id    = mittwald_project.example.id
  default_stack = true

  containers = {
    nginx = {
      description = "Example web server"
      image       = "nginx:1.27.4"
      entrypoint  = ["/docker-entrypoint.sh"]

      // command = ["php -S 0.0.0.0:$PORT"]

      // environment = {
      //   FOO = "bar"
      // }

      ports = [
        {
          container_port = 80
          public_port    = local.nginx_port
          protocol       = "tcp"
        }
      ]

      volumes = [
        {
          project_path = "/html"
          mount_path   = "/usr/share/nginx/html"
        }
      ]
    }
  }

  volumes = {
    example = {

    }
  }
}

resource "mittwald_virtualhost" "nginx" {
  hostname   = "${mittwald_project.test.short_id}.project.space"
  project_id = mittwald_project.test.id

  paths = {
    "/" = {
      container = {
        container_id = mittwald_container_stack.nginx.containers.nginx.id
        port         = "${local.nginx_port}/tcp"
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `containers` (Attributes Map) (see [below for nested schema](#nestedatt--containers))
- `project_id` (String) The ID of the project the container_stack belongs to

### Optional

- `default_stack` (Boolean) Set this flag to use the project's default stack. Otherwise, a new stack will be created.
- `volumes` (Attributes Map) (see [below for nested schema](#nestedatt--volumes))

### Read-Only

- `id` (String) The generated container_stack ID

<a id="nestedatt--containers"></a>
### Nested Schema for `containers`

Required:

- `description` (String) A description for the container.
- `image` (String) The image to use for the container. Follows the usual Docker image format, e.g. `nginx:latest` or `registry.example.com/my-image:latest`.

  Note that when using a non-standard registry (or a standard registry with credentials), you will probably also need to add a `mittwald_container_registry` resource somewhere in your plan.

Optional:

- `command` (List of String) The command to run inside the container.
- `entrypoint` (List of String) The entrypoint to use for the container.
- `environment` (Map of String) A map of environment variables to set inside the container.
- `no_recreate_on_change` (Boolean, [Write-only](https://developer.hashicorp.com/terraform/language/resources/ephemeral#write-only-arguments)) Set this flag to **not** recreate the container if any of the configuration changes. This includes changes to the image, command, entrypoint, environment variables, and ports. If this is set, you will need to manually recreate the container to apply any changes.
- `ports` (Attributes Set) A ports to expose from the container. Follows the format `<public-port>:<container-port>/<protocol>`. (see [below for nested schema](#nestedatt--containers--ports))
- `volumes` (Attributes Set) A list of volumes to mount into the container. (see [below for nested schema](#nestedatt--containers--volumes))

Read-Only:

- `id` (String) The generated container ID

<a id="nestedatt--containers--ports"></a>
### Nested Schema for `containers.ports`

Required:

- `container_port` (Number) The container port to expose.

Optional:

- `protocol` (String) The protocol to use for the port. Defaults to `tcp`.
- `public_port` (Number) The public port to expose; will default to the same value as `container_port`.


<a id="nestedatt--containers--volumes"></a>
### Nested Schema for `containers.volumes`

Required:

- `mount_path` (String) The path to mount the volume to.
- `project_path` (String) Path to a directory in the project filesystem.

Optional:

- `volume` (String) The name of the volume to mount.



<a id="nestedatt--volumes"></a>
### Nested Schema for `volumes`
